// ============================================
// –ü–û–õ–£–ß–ê–ï–ú –≠–õ–ï–ú–ï–ù–¢–´ –°–¢–†–ê–ù–ò–¶–´
// ============================================
const music = document.getElementById("bg-music");
const playPauseBtn = document.getElementById("play-pause-btn");
const rewindBtn = document.getElementById("rewind-btn");
const forwardBtn = document.getElementById("forward-btn");
const volumeSlider = document.getElementById("volume-slider");
const volumeValue = document.getElementById("volume-value");

// –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∑–∞–º–µ—Ç–æ–∫
const addNoteBtn = document.getElementById("add-note-btn");
const saveNoteBtn = document.getElementById("save-note-btn");
const deleteNoteBtn = document.getElementById("delete-note-btn");
const noteText = document.getElementById("note-text");
const notesList = document.getElementById("notes-list");

// –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª–æ—Å—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
const progressSlider = document.getElementById("progress-slider");
const currentTimeDisplay = document.getElementById("current-time");
const totalTimeDisplay = document.getElementById("total-time");

// ============================================
// –°–û–°–¢–û–Ø–ù–ò–ï –ü–õ–ï–ï–†–ê
// ============================================
let isPlaying = false; // –§–ª–∞–≥: –∏–≥—Ä–∞–µ—Ç –ª–∏ –º—É–∑—ã–∫–∞ —Å–µ–π—á–∞—Å
let isDragging = false; // –§–ª–∞–≥: –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª–∑—É–Ω–æ–∫

// ============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´
// ============================================
window.addEventListener("load", () => {
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –≥—Ä–æ–º–∫–æ—Å—Ç—å (0.4 = 40%)
  music.volume = 0.4;
  volumeSlider.value = 40; // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–ª–∞–π–¥–µ—Ä
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
  currentTimeDisplay.textContent = "0:00";
  totalTimeDisplay.textContent = "0:00";
  
  // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—É–∑—ã–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  music.play().then(() => {
    // –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å - –æ–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
    isPlaying = true;
    updatePlayButton();
  }).catch(() => {
    // –ï—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
    console.log("–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.");
    isPlaying = false;
    updatePlayButton();
  });
  
  // ============================================
  // –ó–ê–ü–£–°–ö–ê–ï–ú –ü–ê–î–ê–Æ–©–ò–ï –°–ï–†–î–ï–ß–ö–ò
  // ============================================
  // –°–æ–∑–¥–∞—ë–º –ø–µ—Ä–≤–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ —Å—Ä–∞–∑—É
  createHeart();
  
  // –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ –∫–∞–∂–¥—ã–µ 500 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ (0.5 —Å–µ–∫—É–Ω–¥—ã)
  // setInterval - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
  setInterval(() => {
    createHeart(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–¥–µ—á–∫–∞
  }, 500); // 500 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ = 0.5 —Å–µ–∫—É–Ω–¥—ã
});

// ============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –¢–ï–ö–°–¢–ê –ö–ù–û–ü–ö–ò PLAY/PAUSE
// ============================================
function updatePlayButton() {
  if (isPlaying) {
    // –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ –∏–≥—Ä–∞–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–∞—É–∑—ã
    playPauseBtn.textContent = "‚è∏Ô∏è –ü–∞—É–∑–∞";
  } else {
    // –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ –Ω–µ –∏–≥—Ä–∞–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    playPauseBtn.textContent = "‚ñ∂Ô∏è –í–∫–ª—é—á–∏—Ç—å";
  }
}

// ============================================
// –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ò–ö–ê –ù–ê –ö–ù–û–ü–ö–£ PLAY/PAUSE
// ============================================
playPauseBtn.addEventListener("click", () => {
  if (isPlaying) {
    // –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ –∏–≥—Ä–∞–µ—Ç - —Å—Ç–∞–≤–∏–º –Ω–∞ –ø–∞—É–∑—É
    music.pause();
    isPlaying = false;
  } else {
    // –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ –Ω–µ –∏–≥—Ä–∞–µ—Ç - –∑–∞–ø—É—Å–∫–∞–µ–º
    music.play().then(() => {
      isPlaying = true;
    }).catch((error) => {
      console.error("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", error);
      alert("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –º—É–∑—ã–∫—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –º—É–∑—ã–∫–∏.");
    });
  }
  updatePlayButton(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
});

// ============================================
// –û–ë–†–ê–ë–û–¢–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ì–†–û–ú–ö–û–°–¢–ò
// ============================================
volumeSlider.addEventListener("input", () => {
  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞ (–æ—Ç 0 –¥–æ 100)
  const volume = volumeSlider.value;
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω –æ—Ç 0.0 –¥–æ 1.0 (–¥–ª—è audio.volume)
  music.volume = volume / 100;
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞
  volumeValue.textContent = volume + "%";
});

// ============================================
// –§–£–ù–ö–¶–ò–Ø –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø –í–†–ï–ú–ï–ù–ò
// ============================================
// –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å–µ–∫—É–Ω–¥—ã –≤ —Ñ–æ—Ä–º–∞—Ç "–º–∏–Ω—É—Ç—ã:—Å–µ–∫—É–Ω–¥—ã"
// –ù–∞–ø—Ä–∏–º–µ—Ä: 125 —Å–µ–∫—É–Ω–¥ ‚Üí "2:05"
function formatTime(seconds) {
  // Math.floor() - –æ–∫—Ä—É–≥–ª—è–µ—Ç –≤–Ω–∏–∑ –¥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞
  const minutes = Math.floor(seconds / 60); // –ü–æ–ª—É—á–∞–µ–º –º–∏–Ω—É—Ç—ã (125 / 60 = 2)
  const secs = Math.floor(seconds % 60); // –ü–æ–ª—É—á–∞–µ–º –æ—Å—Ç–∞—Ç–æ–∫ —Å–µ–∫—É–Ω–¥ (125 % 60 = 5)
  
  // padStart(2, '0') - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–ª—å –≤ –Ω–∞—á–∞–ª–µ, –µ—Å–ª–∏ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ 10
  // –ù–∞–ø—Ä–∏–º–µ—Ä: 5 ‚Üí "05", 12 ‚Üí "12"
  return `${minutes}:${secs.toString().padStart(2, '0')}`;
}

// ============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–û–õ–û–°–´ –ü–†–û–ì–†–ï–°–°–ê
// ============================================
function updateProgress() {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—É–∑—ã–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –ø–æ–ª–∑—É–Ω–æ–∫
  if (!isDragging && music.duration) {
    // music.currentTime - —Ç–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    // music.duration - –æ–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç: (—Ç–µ–∫—É—â–µ–µ / –æ–±—â–µ–µ) * 100
    const progress = (music.currentTime / music.duration) * 100;
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–æ—Å—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    progressSlider.value = progress;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    currentTimeDisplay.textContent = formatTime(music.currentTime);
  }
}

// ============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –û–ë–©–ï–ô –î–õ–ò–¢–ï–õ–¨–ù–û–°–¢–ò
// ============================================
music.addEventListener("loadedmetadata", () => {
  // –°–æ–±—ã—Ç–∏–µ "loadedmetadata" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–µ–∫–µ
  // (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ —Å–∞–º –∞—É–¥–∏–æ—Ñ–∞–π–ª)
  if (music.duration) {
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    totalTimeDisplay.textContent = formatTime(music.duration);
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞
    progressSlider.max = 100;
  }
});

// ============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–ì–†–ï–°–°–ê –í–û –í–†–ï–ú–Ø –í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–Ø
// ============================================
music.addEventListener("timeupdate", () => {
  // –°–æ–±—ã—Ç–∏–µ "timeupdate" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–æ –≤—Ä–µ–º—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
  // (–ø—Ä–∏–º–µ—Ä–Ω–æ 4 —Ä–∞–∑–∞ –≤ —Å–µ–∫—É–Ω–¥—É)
  updateProgress(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–æ—Å—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
});

// ============================================
// –ü–ï–†–ï–ú–û–¢–ö–ê –ü–†–ò –ö–õ–ò–ö–ï –ù–ê –ü–û–õ–û–°–£ –ü–†–û–ì–†–ï–°–°–ê
// ============================================
progressSlider.addEventListener("input", () => {
  // –°–æ–±—ã—Ç–∏–µ "input" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞
  isDragging = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç
  
  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞ (–æ—Ç 0 –¥–æ 100)
  const progress = progressSlider.value;
  
  // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  // (–ø—Ä–æ—Ü–µ–Ω—Ç / 100) * –æ–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  if (music.duration) {
    music.currentTime = (progress / 100) * music.duration;
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ä–∞–∑—É
    currentTimeDisplay.textContent = formatTime(music.currentTime);
  }
});

// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–∑—É–Ω–æ–∫
progressSlider.addEventListener("change", () => {
  // –°–æ–±—ã—Ç–∏–µ "change" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–∑—É–Ω–æ–∫
  isDragging = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥
});

// ============================================
// –û–ë–†–ê–ë–û–¢–ö–ê –û–ö–û–ù–ß–ê–ù–ò–Ø –í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–Ø
// ============================================
music.addEventListener("ended", () => {
  // –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å (—Ö–æ—Ç—è —É –Ω–∞—Å loop, —ç—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏)
  isPlaying = false;
  updatePlayButton();
});

// ============================================
// –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–Ø
// ============================================
music.addEventListener("error", (e) => {
  console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º—É–∑—ã–∫–∏:", e);
  alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º—É–∑—ã–∫—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª '–Ø –ª—é–±–ª—é —Ç–µ–±—è –ö—Ä–∏—Å—Ç–∏–Ω–∞.mp3' –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ.");
});

// ============================================
// –ü–ï–†–ï–ú–û–¢–ö–ê –ù–ê–ó–ê–î (-10 –°–ï–ö–£–ù–î)
// ============================================
rewindBtn.addEventListener("click", () => {
  // music.currentTime - —Ç–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  // –í—ã—á–∏—Ç–∞–µ–º 10 —Å–µ–∫—É–Ω–¥
  const newTime = Math.max(0, music.currentTime - 10); // Math.max(0, ...) - –Ω–µ –º–µ–Ω—å—à–µ 0
  music.currentTime = newTime; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é
  console.log(`–ü–µ—Ä–µ–º–æ—Ç–∫–∞ –Ω–∞–∑–∞–¥. –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è: ${Math.floor(newTime)} —Å–µ–∫`);
});

// ============================================
// –ü–ï–†–ï–ú–û–¢–ö–ê –í–ü–ï–†–Å–î (+10 –°–ï–ö–£–ù–î)
// ============================================
forwardBtn.addEventListener("click", () => {
  // music.duration - –æ–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–µ–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  // –î–æ–±–∞–≤–ª—è–µ–º 10 —Å–µ–∫—É–Ω–¥, –Ω–æ –Ω–µ –±–æ–ª—å—à–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–∫–∞
  const newTime = Math.min(music.duration || 0, music.currentTime + 10);
  music.currentTime = newTime; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é
  console.log(`–ü–µ—Ä–µ–º–æ—Ç–∫–∞ –≤–ø–µ—Ä—ë–¥. –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è: ${Math.floor(newTime)} —Å–µ–∫`);
});

// ============================================
// –°–û–•–†–ê–ù–ï–ù–ò–ï –ó–ê–ú–ï–¢–û–ö –í LOCALSTORAGE
// ============================================
// localStorage - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –±—Ä–∞—É–∑–µ—Ä–∞
// –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–∫–æ–º–ø—å—é—Ç–µ—Ä/—Ç–µ–ª–µ—Ñ–æ–Ω)
// –î–∞–∂–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è!

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–º–µ—Ç–æ–∫ –∏–∑ localStorage
function loadNotes() {
  // localStorage.getItem('kristina-notes') - –ø–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
  // JSON.parse() - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –æ–±—Ä–∞—Ç–Ω–æ –≤ –º–∞—Å—Å–∏–≤
  const savedNotes = localStorage.getItem('kristina-notes');
  
  if (savedNotes) {
    // –ï—Å–ª–∏ –∑–∞–º–µ—Ç–∫–∏ –µ—Å—Ç—å - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏—Ö –∏–∑ JSON –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
    return JSON.parse(savedNotes);
  } else {
    // –ï—Å–ª–∏ –∑–∞–º–µ—Ç–æ–∫ –Ω–µ—Ç - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
    return [];
  }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–º–µ—Ç–æ–∫ –≤ localStorage
function saveNotes(notes) {
  // JSON.stringify(notes) - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–∞—Å—Å–∏–≤ –≤ —Å—Ç—Ä–æ–∫—É
  // localStorage.setItem('kristina-notes', ...) - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
  localStorage.setItem('kristina-notes', JSON.stringify(notes));
  console.log('–ó–∞–º–µ—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–º–µ—Ç–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
function displayNotes() {
  const notes = loadNotes(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–º–µ—Ç–∫–∏
  
  // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–º–µ—Ç–æ–∫
  notesList.innerHTML = '';
  
  if (notes.length === 0) {
    // –ï—Å–ª–∏ –∑–∞–º–µ—Ç–æ–∫ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    notesList.innerHTML = '<p style="text-align: center; color: #999;">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∑–∞–º–µ—Ç–æ–∫</p>';
    return;
  }
  
  // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏ –∏ —Å–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π
  notes.forEach((note, index) => {
    // –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–∞–º–µ—Ç–∫–∏
    const noteItem = document.createElement('div');
    noteItem.className = 'note-item';
    
    // –î–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è
    const noteDate = document.createElement('div');
    noteDate.className = 'note-date';
    noteDate.textContent = note.date || '–ë–µ–∑ –¥–∞—Ç—ã';
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞–º–µ—Ç–∫–∏
    const noteContent = document.createElement('div');
    noteContent.className = 'note-content';
    noteContent.textContent = note.text;
    
    // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'delete-note-btn';
    deleteBtn.textContent = '√ó';
    deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É';
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è
    deleteBtn.addEventListener('click', () => {
      if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–º–µ—Ç–∫—É?')) {
        // –£–¥–∞–ª—è–µ–º –∑–∞–º–µ—Ç–∫—É –∏–∑ –º–∞—Å—Å–∏–≤–∞
        notes.splice(index, 1);
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
        saveNotes(notes);
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        displayNotes();
      }
    });
    
    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å—ë –≤–º–µ—Å—Ç–µ
    noteItem.appendChild(noteDate);
    noteItem.appendChild(noteContent);
    noteItem.appendChild(deleteBtn);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫
    notesList.appendChild(noteItem);
  });
}

// ============================================
// –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö –ó–ê–ú–ï–¢–û–ö
// ============================================

// –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" - –æ—á–∏—â–∞–µ—Ç –ø–æ–ª–µ –≤–≤–æ–¥–∞
addNoteBtn.addEventListener('click', () => {
  noteText.value = ''; // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ
  noteText.focus(); // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ (–∫—É—Ä—Å–æ—Ä –≤–Ω—É—Ç—Ä–∏)
});

// –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–º–µ—Ç–∫—É
saveNoteBtn.addEventListener('click', () => {
  const text = noteText.value.trim(); // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏ —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
  
  if (!text) {
    // –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏!');
    return;
  }
  
  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–º–µ—Ç–∫–∏
  const notes = loadNotes();
  
  // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–º–µ—Ç–∫—É
  const newNote = {
    text: text, // –¢–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏
    date: new Date().toLocaleString('ru-RU') // –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤ —Ä—É—Å—Å–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
  };
  
  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–º–µ—Ç–∫—É –≤ –Ω–∞—á–∞–ª–æ –º–∞—Å—Å–∏–≤–∞
  notes.unshift(newNote); // unshift - –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –Ω–∞—á–∞–ª–æ (–Ω–æ–≤—ã–µ –∑–∞–º–µ—Ç–∫–∏ —Å–≤–µ—Ä—Ö—É)
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
  saveNotes(notes);
  
  // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
  noteText.value = '';
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  displayNotes();
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
  alert('–ó–∞–º–µ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞! ‚úÖ');
});

// –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" - —É–¥–∞–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–º–µ—Ç–∫—É
deleteNoteBtn.addEventListener('click', () => {
  const notes = loadNotes();
  
  if (notes.length === 0) {
    alert('–ù–µ—Ç –∑–∞–º–µ—Ç–æ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!');
    return;
  }
  
  if (confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–º–µ—Ç–∫—É?')) {
    notes.shift(); // shift - —É–¥–∞–ª—è–µ—Ç –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç (–ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é)
    saveNotes(notes);
    displayNotes();
    alert('–ó–∞–º–µ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∞!');
  }
});

// ============================================
// –ó–ê–ì–†–£–ó–ö–ê –ó–ê–ú–ï–¢–û–ö –ü–†–ò –û–¢–ö–†–´–¢–ò–ò –°–¢–†–ê–ù–ò–¶–´
// ============================================
// –ö–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
window.addEventListener("load", () => {
  displayNotes(); // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
  
  // ============================================
  // –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø SERVICE WORKER (PWA)
  // ============================================
  // Service Worker –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ñ–ª–∞–π–Ω
  if ('serviceWorker' in navigator) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –±—Ä–∞—É–∑–µ—Ä Service Worker
    navigator.serviceWorker.register('./service-worker.js')
      .then((registration) => {
        // –ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
      })
      .catch((error) => {
        // –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
        console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
      });
  } else {
    console.log('‚ö†Ô∏è Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ');
  }
});

// ============================================
// –§–£–ù–ö–¶–ò–Ø –°–û–ó–î–ê–ù–ò–Ø –ü–ê–î–ê–Æ–©–ï–ì–û –°–ï–†–î–ï–ß–ö–ê
// ============================================
function createHeart() {
  // document.createElement('div') - —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π HTML —ç–ª–µ–º–µ–Ω—Ç <div>
  const heart = document.createElement('div');
  
  // textContent - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ (—Å–∞–º–æ —Å–µ—Ä–¥–µ—á–∫–æ ‚ù§Ô∏è)
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–µ—Ä–¥–µ—á–µ–∫ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
  const hearts = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì'];
  heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
  
  // style.position = 'absolute' - –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ
  // –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å —Å–µ—Ä–¥–µ—á–∫–æ –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  heart.style.position = 'fixed'; // fixed –≤–º–µ—Å—Ç–æ absolute - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞
  
  // style.left - –ø–æ–∑–∏—Ü–∏—è —Å–ª–µ–≤–∞
  // Math.random() * 100 - —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100
  // + '%' - –¥–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "45%")
  // –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–µ—Ä–¥–µ—á–∫–æ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
  heart.style.left = Math.random() * 100 + '%';
  
  // style.top = '-50px' - –Ω–∞—á–∏–Ω–∞–µ–º –°–ù–ê–†–£–ñ–ò —ç–∫—Ä–∞–Ω–∞ (–≤—ã—à–µ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏)
  // –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–¥–µ—á–∫–æ –ø–æ—è–≤–ª—è–ª–æ—Å—å –ø–ª–∞–≤–Ω–æ
  heart.style.top = '-50px';
  
  // style.fontSize - —Ä–∞–∑–º–µ—Ä —Å–µ—Ä–¥–µ—á–∫–∞
  heart.style.fontSize = (Math.random() * 20 + 20) + 'px'; // –û—Ç 20 –¥–æ 40 –ø–∏–∫—Å–µ–ª–µ–π
  
  // style.opacity - –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (1 = –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∏–¥–∏–º–æ–µ, 0 = –Ω–µ–≤–∏–¥–∏–º–æ–µ)
  heart.style.opacity = Math.random() * 0.5 + 0.5; // –û—Ç 0.5 –¥–æ 1.0
  
  // style.zIndex - —Å–ª–æ–π (–±–æ–ª—å—à–µ —á–∏—Å–ª–æ = –≤—ã—à–µ)
  heart.style.zIndex = '9999'; // –°–µ—Ä–¥–µ—á–∫–∏ –±—É–¥—É—Ç –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ (–æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π —Å–ª–æ–π)
  
  // style.pointerEvents = 'none' - —Å–µ—Ä–¥–µ—á–∫–∏ –Ω–µ –±—É–¥—É—Ç –º–µ—à–∞—Ç—å –∫–ª–∏–∫–∞–º
  heart.style.pointerEvents = 'none';
  
  // style.userSelect = 'none' - –Ω–µ–ª—å–∑—è –≤—ã–¥–µ–ª–∏—Ç—å —Å–µ—Ä–¥–µ—á–∫–æ
  heart.style.userSelect = 'none';
  
  // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è (–æ—Ç 2 –¥–æ 4 —Å–µ–∫—É–Ω–¥)
  const duration = Math.random() * 2 + 2; // –û—Ç 2 –¥–æ 4 —Å–µ–∫—É–Ω–¥
  
  // animation - –ø—Ä–∏–º–µ–Ω—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏—é 'fall'
  // 'fall' - –∏–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞–Ω–∞ –≤ CSS)
  // duration + 's' - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  // 'linear' - —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (–±–µ–∑ —É—Å–∫–æ—Ä–µ–Ω–∏—è/–∑–∞–º–µ–¥–ª–µ–Ω–∏—è)
  // 'forwards' - –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–Ω–µ–≤–∏–¥–∏–º—ã–º)
  heart.style.animation = `fall ${duration}s linear forwards`;
  
  // document.body.appendChild(heart) - –¥–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ä–¥–µ—á–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
  // appendChild - –¥–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü body
  document.body.appendChild(heart);
  
  // setTimeout - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è
  // –ß–µ—Ä–µ–∑ duration —Å–µ–∫—É–Ω–¥ (–∫–æ–≥–¥–∞ —Å–µ—Ä–¥–µ—á–∫–æ —É–ø–∞–¥—ë—Ç) —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  // –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ø–∞–º—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞
  setTimeout(() => {
    if (heart.parentNode) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –µ—â—ë –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
      heart.remove(); // –£–¥–∞–ª—è–µ–º —Å–µ—Ä–¥–µ—á–∫–æ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    }
  }, duration * 1000); // –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ 1000, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
}